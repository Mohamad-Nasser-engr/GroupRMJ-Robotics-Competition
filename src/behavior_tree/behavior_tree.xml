<root main_tree_to_execute="MainTree">
    <BehaviorTree ID="MainTree">

        <!-- Sequence for detecting and grabbing the can -->
        <Sequence name="can_sequence">
            <Parallel name="can_detection_parallel" success_threshold="1">
                <DetectCanNode name="detect_can"/>
                <GoToCanNode name="go_to_can"/>
                <UltrasonicDistanceNode name="ultrasonic_distance"/>
            </Parallel>
            <Sequence name="shutdown_can_nodes">
                <Condition name="IsAtCan"/>
                <ScriptNode name="ShutdownCanNodes" code="ros::shutdownNode('detect_can'); ros::shutdownNode('go_to_can'); ros::shutdownNode('ultrasonic_distance');"/>
                <GrabberNode name="grabber"/>
            </Sequence>
        </Sequence>

        <!-- Sequence for detecting the QR code and moving towards it -->
        <Sequence name="qr_sequence">
            <Parallel name="qr_detection_parallel" success_threshold="1">
                <DetectQrNode name="detect_qr"/>
                <GoToQRNode name="go_to_qr"/>
                <LightSensorNode name="light_sensor"/>
            </Parallel>
            <Sequence name="shutdown_qr_nodes">
                <Condition name="IsAtQR"/>
                <ScriptNode name="ShutdownQRNodes" code="ros::shutdownNode('detect_qr'); ros::shutdownNode('go_to_qr'); ros::shutdownNode('light_sensor'); ros::cancelAction('grabber');"/>
            </Sequence>
        </Sequence>

    </BehaviorTree>
</root>
